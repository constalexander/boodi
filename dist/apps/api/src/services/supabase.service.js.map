{
  "version": 3,
  "sources": ["../../../../../apps/api/src/services/supabase.service.ts"],
  "sourcesContent": ["import { createClient } from \"@supabase/supabase-js\";\nimport config from \"../configs/app.config.js\";\nimport { Config } from \"../models/app-config.type.js\";\n\nexport const supabase = createClient(\n  config.supabase.url,\n  config.supabase.serviceRoleKey\n);\n\nexport const fetchPrompt = async (name: any) => {\n  try {\n    const { data, error } = await supabase\n      .from(\"prompts\")\n      .select(\"*\")\n      .eq(\"name\", name);\n    if (error) throw error;\n\n    return data[0]?.value;\n  } catch (error: any) {\n    console.error(\"Error fetching prompts:\", error.message);\n  }\n};\n\nexport const loadPromptsIntoConfig = async () => {\n  for (const p in config.prompts) {\n    const v = await fetchPrompt(p as keyof Config[\"prompts\"]);\n    if (!v) throw new Error(`Prompt for ${p} not found.`);\n    config.prompts[p] = v;\n  }\n};\n\nexport const saveInteraction = async (\n  endpoint: string,\n  input: string,\n  output: string,\n  userUUID?: string\n) => {\n  const values = {\n    endpoint,\n    user_input: input,\n    boodi_output: output,\n    user_uuid: userUUID || null,\n  };\n  const { error } = await supabase.from(\"interactions\").insert(values);\n\n  if (error) {\n    console.error(\"Error saving interaction:\", error);\n    return false;\n  }\n  return true;\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAA6B;AAC7B,wBAAmB;AAGZ,MAAM,eAAW;AAAA,EACtB,kBAAAA,QAAO,SAAS;AAAA,EAChB,kBAAAA,QAAO,SAAS;AAClB;AAEO,MAAM,cAAc,OAAO,SAAc;AAC9C,MAAI;AACF,UAAM,EAAE,MAAM,MAAM,IAAI,MAAM,SAC3B,KAAK,SAAS,EACd,OAAO,GAAG,EACV,GAAG,QAAQ,IAAI;AAClB,QAAI;AAAO,YAAM;AAEjB,WAAO,KAAK,CAAC,GAAG;AAAA,EAClB,SAAS,OAAY;AACnB,YAAQ,MAAM,2BAA2B,MAAM,OAAO;AAAA,EACxD;AACF;AAEO,MAAM,wBAAwB,YAAY;AAC/C,aAAW,KAAK,kBAAAA,QAAO,SAAS;AAC9B,UAAM,IAAI,MAAM,YAAY,CAA4B;AACxD,QAAI,CAAC;AAAG,YAAM,IAAI,MAAM,cAAc,CAAC,aAAa;AACpD,sBAAAA,QAAO,QAAQ,CAAC,IAAI;AAAA,EACtB;AACF;AAEO,MAAM,kBAAkB,OAC7B,UACA,OACA,QACA,aACG;AACH,QAAM,SAAS;AAAA,IACb;AAAA,IACA,YAAY;AAAA,IACZ,cAAc;AAAA,IACd,WAAW,YAAY;AAAA,EACzB;AACA,QAAM,EAAE,MAAM,IAAI,MAAM,SAAS,KAAK,cAAc,EAAE,OAAO,MAAM;AAEnE,MAAI,OAAO;AACT,YAAQ,MAAM,6BAA6B,KAAK;AAChD,WAAO;AAAA,EACT;AACA,SAAO;AACT;",
  "names": ["config"]
}
